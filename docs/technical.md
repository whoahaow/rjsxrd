# Техническая документация

## Архитектура генератора

Генератор конфигов построен с использованием модульной архитектуры:

- `config/` - настройки и конфигурационные параметры
- `fetchers/` - модули для загрузки конфигов из внешних источников
- `processors/` - обработка и фильтрация конфигов
- `utils/` - вспомогательные функции и утилиты

### Основные компоненты

#### Fetcher
- Загружает конфиги из внешних источников (обычные ссылки, base64-кодированные подписки, дополнительные источники для обхода)
- Обрабатывает ошибки и повторные попытки подключения
- Использует сессии с повторными попытками и адаптеры для устойчивости

#### Processor
- Фильтрует конфиги по SNI доменам и CIDR белым спискам для обхода блокировок
- Выполняет дедупликацию по host:port комбинациям
- Обрабатывает base64-кодированные подписки с SNI/CIDR фильтрацией
- Фильтрует конфиги с insecure параметрами для повышения безопасности
- Создает безопасные и небезопасные версии обходных конфигов (папки bypass/ и bypass-unsecure/)
- Разделяет большие файлы на части по 300 конфигов
- Создает протокол-специфичные файлы в обеих версиях (secure и unsecure)
- Создает файлы all.txt и all-secure.txt в папке default/

#### GitHub Handler
- Управляет загрузкой файлов в репозиторий GitHub
- Обрабатывает конфликты SHA и повторные попытки обновления
- Обновляет информацию о файлах

## Алгоритм работы

1. Загрузка конфигов из всех источников (обычные URL, base64-подписки, дополнительные источники для обхода) - параллельно
2. Сохранение обычных конфигов в папку default/
3. Создание безопасных обходных конфигов (папка bypass/) с фильтрацией по SNI доменам и CIDR
4. Создание небезопасных обходных конфигов (папка bypass-unsecure/) с фильтрацией по SNI доменам и CIDR
5. Создание протокол-специфичных файлов в обеих версиях (secure и unsecure) в папке split-by-protocols/
6. Создание файлов all.txt и all-secure.txt в папке default/
7. Загрузка всех файлов в репозиторий GitHub

## Оптимизации

- Параллельные загрузки для ускорения процесса
- Кэширование и проверка изменений для избежания лишних коммитов
- Разделение больших файлов (максимум 300 конфигов на файл) для мобильной производительности
- Умные регулярные выражения для быстрой фильтрации
- Фильтрация конфигов с insecure параметрами для повышения безопасности
- Поддержка обработки различных типов источников (обычные ссылки, base64-подписки)